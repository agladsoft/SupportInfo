<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <h1 class="title">üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤</h1>
        
        <div id="content">
            <!-- XMLRiver Service -->
            <div class="service-section">
                <h2>üí∞ XMLRiver (–Ø–Ω–¥–µ–∫—Å.–ö–æ—à–µ–ª–µ–∫)</h2>
                {% if xmlriver_info.status == "error" %}
                    <div class="error">{{ xmlriver_info.error }}</div>
                {% else %}
                    <div class="info-card">
                        <div class="balance">{{ xmlriver_info.balance }} —Ä—É–±–ª–µ–π</div>
                        <div class="cost">–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞: {{ xmlriver_info.cost_per_request }} –∫–æ–ø–µ–π–∫–∏</div>
                        <div class="rows">–î–æ—Å—Ç—É–ø–Ω–æ —Å—Ç—Ä–æ–∫: {{ xmlriver_info.rows_available }}</div>
                    </div>
                {% endif %}
            </div>

            <!-- Database Service -->
            <div class="service-section">
                <h2>üõ¢Ô∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ClickHouse</h2>
                {% if database_info.status == "error" %}
                    <div class="error">{{ database_info.error }}</div>
                {% else %}
                    <div class="info-card">
                        <div class="status-ok">{{ database_info.connection_status }}</div>
                        {% if database_info.response_time %}
                            <div class="response-time">–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞: {{ database_info.response_time }}</div>
                        {% endif %}
                    </div>
                {% endif %}
            </div>

            <!-- INN Section -->
            {% if database_info.unique_companies_count is not none %}
                <div class="service-section">
                    <h2>üè¢ –ò–ù–ù</h2>
                    <div class="info-card inn-card">
                        <div class="inn-count">{{ database_info.unique_companies_count }}</div>
                        <div class="inn-description">
                            <div>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π. –ó–∞–ø—Ä–æ—Å —Å—á–∏—Ç–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –∫–æ–º–ø–∞–Ω–∏—è–º, —É –∫–æ—Ç–æ—Ä—ã—Ö:</div>
                            <ul class="inn-criteria">
                                <li>–Ω–µ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ FTS</li>
                                <li>–ò–ù–ù –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω (is_checked_inn = false –∏–ª–∏ NULL)</li>
                                <li>—É –æ–¥–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –ò–ù–ù</li>
                                <li>–∏—Å–∫–ª—é—á–µ–Ω—ã —Ñ–∞–π–ª—ã –æ—Ç –ü—å—è–Ω–∫–æ–≤–∞ (–Æ–∂–Ω–æ-–°–∞—Ö–∞–ª–∏–Ω—Å–∫)</li>
                                <li>–æ–±–∞ –ø–æ–ª—è company_inn –∏ company_name_unified –∑–∞–ø–æ–ª–Ω–µ–Ω—ã</li>
                            </ul>
                        </div>
                    </div>
                </div>
            {% endif %}

            <!-- DaData Service -->
            <div class="service-section">
                <h2>üìä DaData API</h2>
                {% if dadata_info.status == "error" %}
                    <div class="error">{{ dadata_info.error }}</div>
                {% else %}
                    <div class="info-card">
                        {% for account in dadata_info.accounts %}
                            <div class="dadata-account">
                                <strong>{{ account.account_name }}</strong><br>
                                –î–∞—Ç–∞: {{ account.date }}<br>
                                –û—Å—Ç–∞–ª–æ—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤: <span class="remaining">{{ account.remaining_requests }}</span>
                            </div>
                            {% if not loop.last %}<hr class="account-separator">{% endif %}
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <!-- System Monitoring -->
            <div class="service-section">
                <h2>üñ•Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã</h2>
                {% if system_info.status == "error" %}
                    <div class="error">{{ system_info.error }}</div>
                {% else %}
                    <div class="info-card">
                        <div class="system-resource">
                            <strong>üíæ –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å:</strong><br>
                            –ó–∞–Ω—è—Ç–æ: {{ system_info.ram_percent }}% ({{ system_info.ram_used_gb }})
                        </div>
                        <hr class="resource-separator">
                        <div class="system-resource">
                            <strong>üíø –î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ:</strong><br>
                            –ó–∞–Ω—è—Ç–æ: {{ system_info.disk_percent }}% ({{ system_info.disk_used_gb }})
                        </div>
                        <hr class="resource-separator">
                        <div class="system-resource">
                            <strong>‚ö° –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä (CPU):</strong><br>
                            –ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å: {{ system_info.cpu_percent }}%
                        </div>
                    </div>
                {% endif %}
            </div>

        </div>
        
        <button class="refresh-btn" onclick="refreshAllServices()" id="refreshBtn">
            üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        </button>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...
        </div>
        
    </div>

    <script src="/static/js/main.js?v=1757342653"></script>
</body>
</html>